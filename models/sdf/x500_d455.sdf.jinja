{% if enable_d455 %}

  <link name="d455_link">
    <pose>0.086 0 -0.05 3.1415 0 1.5708</pose>
    {# <pose>0.1558 0 -0.0605 1.5708 0 1.5708</pose> #}
    <inertial>
      <mass>0.072</mass>
      <inertia>
        <ixx>0.00388124</ixx>
        <ixy>1.0842e-19</ixy>
        <ixz>-1.0842e-19</ixz>
        <iyy>0.00049894</iyy>
        <iyz>2.71051e-20</iyz>
        <izz>0.00387926</izz>
      </inertia>
    </inertial>
    
    <visual name="d455_visual">
      <pose>0 0 0 0 0 0</pose>
      <geometry>
        <mesh>
          <uri>model://mrs_robots_description/meshes/custom/d455/d455.stl</uri>
          <scale>0.001 0.001 0.001</scale>
        </mesh>
      </geometry>
    </visual>

    <collision name="d455_collision">
      <pose>0.1427 0 -0.0605 0 0 0</pose>
      <geometry>
        <box>
          <size>0.026 0.124 0.029</size>
        </box>
      </geometry>
      <surface>
        <contact>
          <ode>
            <kp>1e+13</kp>
            <kd>1</kd>
          </ode>
        </contact>
        <friction>
          <ode>
            <mu2>1</mu2>
            <fdir1>0 0 0</fdir1>
          </ode>
        </friction>
      </surface>
    </collision>
    
    <self_collide>0</self_collide>
    <enable_wind>0</enable_wind>
    <kinematic>0</kinematic>
    <gravity>1</gravity>

    <sensor name='d455color' type='camera'>
      <camera name='d455'>
        <horizontal_fov>1.51844</horizontal_fov>
        <image>
          <width>640</width>
          <height>480</height>
          <format>RGB_INT8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <mean>0</mean>
          <stddev>0.007</stddev>
        </noise>
      </camera>
      <always_on>1</always_on>
      <update_rate>30</update_rate>
      <visualize>0</visualize>
      <pose>0.15115 0.0475 -0.0605 0 -0 0</pose>
    </sensor>

    <sensor name='d455ired1' type='camera'>
      <camera name='d455'>
        <horizontal_fov>1.51844</horizontal_fov>
        <image>
          <width>1280</width>
          <height>720</height>
          <format>L_INT8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <mean>0</mean>
          <stddev>0.05</stddev>
        </noise>
      </camera>
      <always_on>1</always_on>
      <update_rate>90</update_rate>
      <visualize>0</visualize>
      <pose>0.15115 0.0475 -0.0605 0 -0 0</pose>
    </sensor>

    <sensor name='d455ired2' type='camera'>
      <camera name='d455'>
        <horizontal_fov>1.51844</horizontal_fov>
        <image>
          <width>1280</width>
          <height>720</height>
          <format>L_INT8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <mean>0</mean>
          <stddev>0.05</stddev>
        </noise>
      </camera>
      <always_on>1</always_on>
      <update_rate>90</update_rate>
      <visualize>0</visualize>
      <pose>0.15115 0.0475 -0.0605 0 -0 0</pose>
    </sensor>

    <sensor name='d455depth' type='depth'>
      <camera name='d455'>
        <horizontal_fov>1.51844</horizontal_fov>
        <image>
          <width>1280</width>
          <height>720</height>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <mean>0</mean>
          <stddev>0.1</stddev>
        </noise>
      </camera>
      <always_on>1</always_on>
      <update_rate>90</update_rate>
      <visualize>0</visualize>
      <pose>0.15115 0.0475 -0.0605 0 -0 0</pose>
    </sensor>
  </link>
  
  <joint name="d455_joint" type="fixed">
    <parent>base_link</parent>
    <child>d455_link</child>
    <pose>0 0 0 0 0 0</pose>
  </joint>

  <plugin name='camera' filename='librealsense_gazebo_plugin.so'>
    <prefix>d455</prefix>
    <depthUpdateRate>30.0</depthUpdateRate>
    <colorUpdateRate>30.0</colorUpdateRate>
    <infraredUpdateRate>30.0</infraredUpdateRate>
    <depthTopicName>depth/image_raw</depthTopicName>
    <depthCameraInfoTopicName>depth/camera_info</depthCameraInfoTopicName>
    <colorTopicName>color/image_raw</colorTopicName>
    <colorCameraInfoTopicName>color/camera_info</colorCameraInfoTopicName>
    <infrared1TopicName>infra1/image_raw</infrared1TopicName>
    <infrared1CameraInfoTopicName>infra1/camera_info</infrared1CameraInfoTopicName>
    <infrared2TopicName>infra2/image_raw</infrared2TopicName>
    <infrared2CameraInfoTopicName>infra2/camera_info</infrared2CameraInfoTopicName>
    <colorOpticalframeName>d455_color_optical_frame</colorOpticalframeName>
    <depthOpticalframeName>d455_depth_optical_frame</depthOpticalframeName>
    <infrared1OpticalframeName>d455_infra1_ir_optical_frame</infrared1OpticalframeName>
    <infrared2OpticalframeName>d455_infra2_ir_optical_frame</infrared2OpticalframeName>
    <rangeMinDepth>0.520</rangeMinDepth>
    <rangeMaxDepth>10.0</rangeMaxDepth>
    <pointCloud>1</pointCloud>
    <pointCloudTopicName>depth/color/points</pointCloudTopicName>
    <pointCloudCutoff>0.25</pointCloudCutoff>
    <pointCloudCutoffMax>9.0</pointCloudCutoffMax>
  </plugin>

  <frame name='d455_accel_optical_joint' attached_to='d455_accel_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_accel_optical_frame' attached_to='d455_accel_optical_joint'/>

  <frame name='d455_accel_joint' attached_to='d455_link'>
    <pose>-0.01602 -0.03022 0.0074 0 -0 0</pose>
  </frame>

  <frame name='d455_accel_frame' attached_to='d455_accel_joint'/>

  <frame name='d455_color_optical_joint' attached_to='d455_color_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_color_optical_frame' attached_to='d455_color_optical_joint'/>

  <frame name='d455_color_joint' attached_to='d455_link'>
    <pose>0 -0.059 0 0 -0 0</pose>
  </frame>

  <frame name='d455_color_frame' attached_to='d455_color_joint'/>

  <frame name='d455_depth_optical_joint' attached_to='d455_depth_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_depth_optical_frame' attached_to='d455_depth_optical_joint'/>

  <frame name='d455_depth_joint' attached_to='d455_link'>
    <pose>0 0 0 0 -0 0</pose>
  </frame>

  <frame name='d455_depth_frame' attached_to='d455_depth_joint'/>

  <frame name='d455_imu_optical_joint' attached_to='d455_gyro_optical_frame'>
    <pose>0 0 0 0 -0 0</pose>
  </frame>

  <frame name='d455_imu_optical_frame' attached_to='d455_imu_optical_joint'/>

  <frame name='d455_gyro_optical_joint' attached_to='d455_gyro_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_gyro_optical_frame' attached_to='d455_gyro_optical_joint'/>

  <frame name='d455_gyro_joint' attached_to='d455_link'>
    <pose>-0.01602 -0.03022 0.0074 0 -0 0</pose>
  </frame>

  <frame name='d455_gyro_frame' attached_to='d455_gyro_joint'/>

  <frame name='d455_infra1_optical_joint' attached_to='d455_infra1_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_infra1_optical_frame' attached_to='d455_infra1_optical_joint'/>

  <frame name='d455_infra1_joint' attached_to='d455_link'>
    <pose>0 0 0 0 -0 0</pose>
  </frame>

  <frame name='d455_infra1_frame' attached_to='d455_infra1_joint'/>

  <frame name='d455_infra2_optical_joint' attached_to='d455_infra2_frame'>
    <pose>0 0 0 -1.5708 -0 -1.5708</pose>
  </frame>

  <frame name='d455_infra2_optical_frame' attached_to='d455_infra2_optical_joint'/>

  <frame name='d455_infra2_joint' attached_to='d455_link'>
    <pose>0 -0.095 0 0 -0 0</pose>
  </frame>

  <frame name='d455_infra2_frame' attached_to='d455_infra2_joint'/>

  <frame name='d455_link_joint' attached_to='d455_bottom_screw_frame'>
    <pose>0.01115 0.0475 0.0145 0 -0 0</pose>
  </frame>

  <frame name='d455_link' attached_to='d455_link_joint'/>

  <frame name='d455_joint' attached_to='base_link'>
    <pose>0.14 0 -0.075 0 -0 0</pose>
  </frame>

  <frame name='d455_bottom_screw_frame' attached_to='d455_joint'/>

  <frame name='d455_link' attached_to='base_link'>
    <pose>0 0 0 0 0 0</pose>
  </frame>
  
{% endif %}